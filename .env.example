# MagnusBilling API Configuration
# Base URL of your MagnusBilling instance (no trailing slash)
MAGNUSBILLING_URL=https://sip.talkusa.net/mbilling
# MagnusBilling API credentials (keep secret)
MAGNUSBILLING_API_KEY=678yidwhnaer738wt52387ywdndsk844
MAGNUSBILLING_API_SECRET=sjksdfh47rw498rwuijerrr8wo3iue83ywrdnas
# Path used by some MagnusBilling installs for user API operations
MAGNUSBILLING_USER_PATH=/user
# Hostname used for TLS SNI / certificate verification
MAGNUSBILLING_TLS_SERVERNAME=sip.talkusa.net
# Set to 1 only for temporary testing if the certificate cannot be validated
# MAGNUSBILLING_TLS_INSECURE=1
# When connecting to an IP but routing to a vhost, set Host header to the domain
MAGNUSBILLING_HOST_HEADER=sip.talkusa.net

# Optional but recommended for clarity: SIP domain presented to users
SIP_DOMAIN=sip.talkusa.net

# Enable verbose application logging when set to 1
DEBUG=1

# App session secret (used to sign login cookies). Change this to a long random string before deploying.
SESSION_SECRET=talkusa_784hedwnwdwew74wdhwh87fwh7wbv

# Token used to protect /api/admin endpoints
ADMIN_TOKEN=8738jdmxkwaru4woq44853798widjsanewj48489
# Default Group and Plan IDs for new MagnusBilling users
DEFAULT_GROUP_ID=3
DEFAULT_PLAN_ID=1

# Optional overrides if your MagnusBilling uses different module names or filters
# MB_SIP_MODULE=sip
# MB_CDR_MODULE=call
# MB_PAGE_SIZE=50
# MagnusBilling CDR import (background mirror) tuning
MB_CDR_IMPORT_INTERVAL_SECONDS=30
MB_CDR_IMPORT_PAGE_SIZE=2500
MB_CDR_IMPORT_MAX_PAGES=20
MB_CDR_IMPORT_LOOKBACK_MINUTES=1440

# Server Configuration
# Public HTTP port the Express app listens on
PORT=8080
# Set to 'production' in live environments
NODE_ENV=production
# For HTTPS-only cookies in production (set to 1 when always behind HTTPS/Proxy)
COOKIE_SECURE=1

# Email verification (SMTP2GO)
SMTP2GO_API_KEY=api-6F733000E2914A7B9204F41BF4C185CF
SMTP2GO_SENDER=no-reply@talkusa.net
SENDER_DOMAIN=talkusa.net
EMAIL_VERIFICATION_TTL_MINUTES=10
# Password reset settings
PASSWORD_RESET_TTL_MINUTES=15
PASSWORD_RESET_MAX_ATTEMPTS=5
# Admin notifications (signup & payments)
ADMIN_NOTIFY_EMAIL=partners@truesip.net

# Database (MySQL 8)
DATABASE_URL=


# DIDWW API Configuration
DIDWW_API_KEY=kljhGGh3v4eoEloymiyFiQUtCRMCJBkx
# DIDWW_API_URL=https://api.didww.com/v3

# phone.systems (telecom.center Operator API)
# Operator API base URL (sandbox: https://api.sandbox.telecom.center)
TELECOM_CENTER_BASE_URL=https://api.telecom.center
# Operator API basic auth credentials
TELECOM_CENTER_USERNAME=
TELECOM_CENTER_PASSWORD=
# Max Phone.System customers per TalkUSA user (default 5)
PHONE_SYSTEM_MAX_CUSTOMERS=5
# Capacity Pool Configuration (use either ID or NAME)
DIDWW_CAPACITY_POOL_ID=4d94c5ae-8d67-4635-857f-90df7f867949
# DIDWW_CAPACITY_POOL_NAME=Standard

# DIDWW Voice IN CDR Streaming (Call Events API)
# These must match the DIDWW portal config for Voice IN CDR Streaming.
DIDWW_CDR_BASIC_USER=56783talkusa
DIDWW_CDR_BASIC_PASS=345688uytrresxcASRETR56aq2345

# DIDWW HTTP SMS OUT (Outbound SMS)
# Configure an "HTTP SMS OUT" trunk in DIDWW and whitelist this server's public IP.
DIDWW_SMS_OUT_BASE_URL=https://sms-out.didww.com
DIDWW_SMS_OUT_USERNAME=
DIDWW_SMS_OUT_PASSWORD=
# Optional: webhook token to secure DIDWW status/DLR callbacks.
# Configure your DIDWW trunk callback URL to include this token, e.g.:
#   PUBLIC_BASE_URL + /webhooks/didww/sms-out?token=YOUR_TOKEN
DIDWW_SMS_OUT_WEBHOOK_TOKEN=

# AI Agents (Pipecat Cloud + Daily Telephony)
# Pipecat Cloud control plane credentials
# - Private API key is used for control plane operations (create agents, manage secrets)
PIPECAT_PRIVATE_API_KEY=your_pipecat_private_key
# - Public API key is required for /public/* endpoints like /public/{agentName}/start
PIPECAT_PUBLIC_API_KEY=your_pipecat_public_api_key
PIPECAT_API_URL=https://api.pipecat.daily.co/v1
PIPECAT_ORG_ID=your_pipecat_org_id
# Container image that runs the Pipecat agent (your build)
PIPECAT_AGENT_IMAGE=your-org/your-agent-image:latest
PIPECAT_REGION=us-west
PIPECAT_AGENT_PROFILE=agent-1x
# Autoscaling + integrations
PIPECAT_MIN_AGENTS=0
PIPECAT_MAX_AGENTS=50
PIPECAT_ENABLE_KRISP=1
# Optional: secret set used to pull private images
# PIPECAT_IMAGE_PULL_SECRET_SET=your_pull_secret_set
# Pipecat public webhook base used for Daily pinless dial-in routing
PIPECAT_DIALIN_WEBHOOK_BASE=https://api.pipecat.daily.co/v1/public/webhooks

# Optional: route Daily pinless dial-in callbacks through this server so inbound AI calls
# are logged into Call History. If unset, the server will use PUBLIC_BASE_URL + /webhooks/daily/dialin.
# AI_DIALIN_WEBHOOK_BASE=https://portal.talkusa.net/webhooks/daily/dialin

# Optional shared secret appended to room_creation_api as ?token=... and verified by our webhook.
# DAILY_DIALIN_WEBHOOK_TOKEN=change_me
# NOTE: This token is also used for /webhooks/daily/events to record call end + durations.

# Daily Telephony API
DAILY_API_KEY=your_daily_api_key
DAILY_API_URL=https://api.daily.co/v1
# Outbound Dialer (Pipecat dial-out worker)
# Set interval to 0 to disable the worker
DIALER_WORKER_INTERVAL_SECONDS=10
# Daily room TTL in seconds for dial-out sessions
DIALER_DAILY_ROOM_TTL_SECONDS=1800
# Dialer outbound call billing (per-minute equivalent, billed per second by default)
DIALER_OUTBOUND_RATE_PER_MIN=0.015
# If 1, dialer outbound calls are billed in whole-minute increments (rounded up).
DIALER_OUTBOUND_BILLING_ROUND_UP_TO_MINUTE=0

# Provider API keys used by the agent runtime (platform-wide)
DEEPGRAM_API_KEY=your_deepgram_api_key
CARTESIA_API_KEY=your_cartesia_api_key
XAI_API_KEY=your_xai_api_key

# Required for storing per-user SMTP passwords and per-agent action tokens (AES-256-GCM)
# Generate: openssl rand -base64 32
USER_SMTP_ENCRYPTION_KEY=

# Optional: portal base URL passed to the agent runtime. If unset, the server will fall back to PUBLIC_BASE_URL.
# PORTAL_BASE_URL=https://portal.talkusa.net

# Optional: LibreOffice binary path for DOCX â†’ PDF conversion (server-side)
# If unset, the server will try "soffice" and then "libreoffice" on PATH.
# LIBREOFFICE_BIN=/usr/bin/soffice

# Per-user limits
AI_MAX_AGENTS=5
AI_MAX_NUMBERS=5

# AI tool usage pricing (USD)
AI_EMAIL_SEND_COST=1
AI_VIDEO_MEETING_LINK_COST=5
AI_SMS_SEND_COST=0.1

# Physical mail (Click2Mail) - disabled by default for safety.
# Set to 1 to allow AI agents to submit physical mail jobs.
AI_PHYSICAL_MAIL_ENABLED=0

# TalkUSA DID markup pricing (monthly, in USD)
# Local DIDs will be billed this amount per month
DID_LOCAL_MONTHLY_MARKUP=10.20
# Toll-free DIDs will be billed this amount per month
DID_TOLLFREE_MONTHLY_MARKUP=25.20

# Inbound call billing (per-second, using per-minute equivalent rates, in USD)
# Example: if INBOUND_LOCAL_RATE_PER_MIN=0.01 then 60 seconds costs $0.01, 2 seconds costs ~$0.00033
# Local inbound calls (per-minute equivalent)
INBOUND_LOCAL_RATE_PER_MIN=0.015
# Toll-free inbound calls (per-minute equivalent)
INBOUND_TOLLFREE_RATE_PER_MIN=0.02

# AI inbound call billing (Daily dial-in -> Pipecat)
# Defaults to INBOUND_* rates above if not set.
AI_INBOUND_LOCAL_RATE_PER_MIN=0.015
AI_INBOUND_TOLLFREE_RATE_PER_MIN=0.02
# If 1, AI inbound calls are billed in whole-minute increments (rounded up).
# Default is per-second (DIDWW-style).
AI_INBOUND_BILLING_ROUND_UP_TO_MINUTE=0

# AI caller memory (returning caller context)
# If enabled, returning callers will carry over recent conversation history into the agent prompt.
AI_CALLER_MEMORY_ENABLE=1
# How many prior calls to consider (currently the agent uses only the most recent call, but this caps DB work).
AI_CALLER_MEMORY_MAX_CALLS=1
# Maximum number of prior user/assistant messages to inject into the model context.
AI_CALLER_MEMORY_MAX_MESSAGES=20
# Max characters per injected message (truncated).
AI_CALLER_MEMORY_MAX_CHARS_PER_MESSAGE=500
# Only look back this many days when searching for prior calls.
AI_CALLER_MEMORY_MAX_DAYS=30

# AI phone number monthly service fees (Daily Telephony)
# Defaults to DID_* markup pricing below if not set.
AI_DID_LOCAL_MONTHLY_FEE=10.20
AI_DID_TOLLFREE_MONTHLY_FEE=25.20

# Markup billing scheduler interval (minutes)
# Set to 0 or omit to disable background markup billing
BILLING_MARKUP_INTERVAL_MINUTES=5

# NOWPayments configuration (crypto payment gateway)
# IMPORTANT: keep these values secret in production
NOWPAYMENTS_API_KEY=KS4EKYP-MFDMDHA-GFVECCY-MK6AXZA
NOWPAYMENTS_PUBLIC_KEY=3ca1eaea-cc27-4c94-ae58-cf293e5dcfbf
# Generate this in NOWPayments dashboard -> IPN settings
NOWPAYMENTS_IPN_SECRET=/Yr7PrlSRy0lekTYtfG9P/B7MqLqKM2V
# Public base URL of this app (used for IPN + success URLs), e.g. https://portal.talkusa.net
PUBLIC_BASE_URL=https://www.talkusa.net

# Card checkout provider for "Add Funds" (card payments)
# Options: square | stripe | dodopayments
CARD_PAYMENT_PROVIDER=square

# Stripe Checkout (hosted card payments)
STRIPE_SECRET_KEY=your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret

# Dodo Payments (hosted card payments via Checkout Sessions)
# NOTE: For variable-dollar refills, create a "pay-what-you-want" product in Dodo and set its product id below.
DODO_PAYMENTS_API_KEY=
DODO_PAYMENTS_WEBHOOK_SECRET=
DODO_PAYMENTS_REFILL_PRODUCT_ID=

# Webhook URL (configure in Dodo dashboard)
# DODO_PAYMENTS_WEBHOOK_URL=https://www.talkusa.net/webhooks/dodopayments

# Square (card payments via Square Payment Links)
# Environment: sandbox or production
SQUARE_ENVIRONMENT=production
SQUARE_APPLICATION_ID=sq0idp-ZQPOPXes6gc_KYED4SqUyg
SQUARE_ACCESS_TOKEN=EAAAl9E3sihjQe-IN8VdDRJFGhunjsD7jLAE4LNNEgFfycucnR4oH-FU9tDdlpf1
# Optional: override location; if omitted, the server will auto-discover the default location using the access token
SQUARE_LOCATION_ID=LYAXASNXXSQPZ
# Webhook verification (set these after configuring the webhook in Square dashboard)
SQUARE_WEBHOOK_SIGNATURE_KEY=U34aTLkQ6KYN3b_9y6lN4A
SQUARE_WEBHOOK_NOTIFICATION_URL=https://www.talkusa.net/webhooks/square

# Bill.com / BILL (invoice + payment link)
# Environment: sandbox or production
BILLCOM_ENVIRONMENT=sandbox
# Required credentials (API user)
BILLCOM_USERNAME=
BILLCOM_PASSWORD=
BILLCOM_ORGANIZATION_ID=
BILLCOM_DEV_KEY=
# Webhook signature verification (from BILL connect-events subscription response)
BILLCOM_WEBHOOK_SECURITY_KEY=


#Stripe
pk_test_51SfxR349fh9b4CBQtPElvKkhXZgjjcHXCHIy2hoOwRWAS1yboSe7VkWwoyoLMmrB2ykPJeBAVWy7dyAoaZjjEgLC00V0lnBRXz

# Checkout limits for Add Funds (USD)
CHECKOUT_MIN_AMOUNT=100
CHECKOUT_MAX_AMOUNT=250
