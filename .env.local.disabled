# MagnusBilling API Configuration
# Base URL of your MagnusBilling instance (no trailing slash)
MAGNUSBILLING_URL=https://sip.talkusa.net/mbilling
# MagnusBilling API credentials (keep secret)
MAGNUSBILLING_API_KEY=678yidwhnaer738wt52387ywdndsk844
MAGNUSBILLING_API_SECRET=sjksdfh47rw498rwuijerrr8wo3iue83ywrdnas
# Path used by some MagnusBilling installs for user API operations
MAGNUSBILLING_USER_PATH=/user
# Hostname used for TLS SNI / certificate verification
MAGNUSBILLING_TLS_SERVERNAME=sip.talkusa.net
# Set to 1 only for temporary testing if the certificate cannot be validated
# MAGNUSBILLING_TLS_INSECURE=1
# When connecting to an IP but routing to a vhost, set Host header to the domain
MAGNUSBILLING_HOST_HEADER=sip.talkusa.net

# Optional but recommended for clarity: SIP domain presented to users
SIP_DOMAIN=sip.talkusa.net

# Enable verbose application logging when set to 1
DEBUG=1

# App session secret (used to sign login cookies). Change this to a long random string before deploying.
SESSION_SECRET=talkusa_784hedwnwdwew74wdhwh87fwh7wbv

# Token used to protect /api/admin endpoints
ADMIN_TOKEN=8738jdmxkwaru4woq44853798widjsanewj48489
# Default Group and Plan IDs for new MagnusBilling users
DEFAULT_GROUP_ID=3
DEFAULT_PLAN_ID=1

# Optional overrides if your MagnusBilling uses different module names or filters
# MB_SIP_MODULE=sip
# MB_CDR_MODULE=call
# MB_PAGE_SIZE=50

# MagnusBilling CDR import (background mirror) tuning
MB_CDR_IMPORT_INTERVAL_SECONDS=30
MB_CDR_IMPORT_PAGE_SIZE=2500
MB_CDR_IMPORT_MAX_PAGES=20
MB_CDR_IMPORT_LOOKBACK_MINUTES=1440

# Server Configuration
# Public HTTP port the Express app listens on
PORT=8080
# Set to 'production' in live environments
NODE_ENV=production
# For HTTPS-only cookies in production (set to 1 when always behind HTTPS/Proxy)
COOKIE_SECURE=1

# Email verification (SMTP2GO)
SMTP2GO_API_KEY=api-6F733000E2914A7B9204F41BF4C185CF
SMTP2GO_SENDER=no-reply@talkusa.net
SENDER_DOMAIN=talkusa.net
EMAIL_VERIFICATION_TTL_MINUTES=10
# Admin notifications (signup & payments)
ADMIN_NOTIFY_EMAIL=partners@truesip.net

# Database (MySQL 8)
DATABASE_URL=<redacted>

# DIDWW API Configuration
DIDWW_API_KEY=kljhGGh3v4eoEloymiyFiQUtCRMCJBkx
# DIDWW_API_URL=https://api.didww.com/v3
# Capacity Pool Configuration (use either ID or NAME)
DIDWW_CAPACITY_POOL_ID=4d94c5ae-8d67-4635-857f-90df7f867949
# DIDWW_CAPACITY_POOL_NAME=Standard

# DIDWW Voice IN CDR Streaming (Call Events API)
# These must match the DIDWW portal config for Voice IN CDR Streaming.
DIDWW_CDR_BASIC_USER=56783talkusa
DIDWW_CDR_BASIC_PASS=345688uytrresxcASRETR56aq2345

# TalkUSA DID markup pricing (monthly, in USD)
# Local DIDs will be billed this amount per month
DID_LOCAL_MONTHLY_MARKUP=10.20
# Toll-free DIDs will be billed this amount per month
DID_TOLLFREE_MONTHLY_MARKUP=25.20

# Inbound call billing (per-second, using per-minute equivalent rates, in USD)
# Example: if INBOUND_LOCAL_RATE_PER_MIN=0.01 then 60 seconds costs $0.01, 2 seconds costs ~$0.00033
# Local inbound calls (per-minute equivalent)
INBOUND_LOCAL_RATE_PER_MIN=0.015
# Toll-free inbound calls (per-minute equivalent)
INBOUND_TOLLFREE_RATE_PER_MIN=0.02

# AI inbound call billing (Daily dial-in -> Pipecat)
# Defaults to INBOUND_* rates above if not set.
AI_INBOUND_LOCAL_RATE_PER_MIN=0.015
AI_INBOUND_TOLLFREE_RATE_PER_MIN=0.02
# If 1, AI inbound calls are billed in whole-minute increments (rounded up).
# Default is per-second (DIDWW-style).
AI_INBOUND_BILLING_ROUND_UP_TO_MINUTE=0

# AI phone number monthly service fees (Daily Telephony)
# Defaults to DID_* markup pricing below if not set.
AI_DID_LOCAL_MONTHLY_FEE=10.20
AI_DID_TOLLFREE_MONTHLY_FEE=25.20

# Markup billing scheduler interval (minutes)
# Set to 0 or omit to disable background markup billing
BILLING_MARKUP_INTERVAL_MINUTES=5

# Required for storing per-user SMTP passwords and per-agent action tokens (AES-256-GCM)
# Generate: openssl rand -base64 32
USER_SMTP_ENCRYPTION_KEY=

# Optional: portal base URL passed to the agent runtime. If unset, the server will fall back to PUBLIC_BASE_URL.
# PORTAL_BASE_URL=https://portal.talkusa.net

# Optional: LibreOffice binary path for DOCX â†’ PDF conversion (server-side)
# If unset, the server will try "soffice" and then "libreoffice" on PATH.
# LIBREOFFICE_BIN=/usr/bin/soffice

# NOWPayments configuration (crypto payment gateway)
# IMPORTANT: keep these values secret in production
NOWPAYMENTS_API_KEY=KS4EKYP-MFDMDHA-GFVECCY-MK6AXZA
NOWPAYMENTS_PUBLIC_KEY=3ca1eaea-cc27-4c94-ae58-cf293e5dcfbf
# Generate this in NOWPayments dashboard -> IPN settings
NOWPAYMENTS_IPN_SECRET=/Yr7PrlSRy0lekTYtfG9P/B7MqLqKM2V
# Public base URL of this app (used for IPN + success URLs), e.g. https://portal.talkusa.net
PUBLIC_BASE_URL=https://www.talkusa.net

# Card checkout provider for "Add Funds" (card payments)
# Options: square | stripe
CARD_PAYMENT_PROVIDER=square

# Stripe Checkout (hosted card payments)
STRIPE_SECRET_KEY=your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret

# Square (card payments via Square Payment Links)
# Environment: sandbox or production
SQUARE_ENVIRONMENT=production
SQUARE_APPLICATION_ID=sq0idp-ZQPOPXes6gc_KYED4SqUyg
SQUARE_ACCESS_TOKEN=EAAAl9E3sihjQe-IN8VdDRJFGhunjsD7jLAE4LNNEgFfycucnR4oH-FU9tDdlpf1
# Optional: override location; if omitted, the server will auto-discover the default location using the access token
SQUARE_LOCATION_ID=LYAXASNXXSQPZ
# Webhook verification (set these after configuring the webhook in Square dashboard)
SQUARE_WEBHOOK_SIGNATURE_KEY=U34aTLkQ6KYN3b_9y6lN4A
SQUARE_WEBHOOK_NOTIFICATION_URL=https://www.talkusa.net/webhooks/square

# Bill.com / BILL (invoice + payment link)
# Environment: sandbox or production
BILLCOM_ENVIRONMENT=sandbox
# Required credentials (API user)
BILLCOM_USERNAME=
BILLCOM_PASSWORD=
BILLCOM_ORGANIZATION_ID=
BILLCOM_DEV_KEY=
# Webhook signature verification (from BILL connect-events subscription response)
BILLCOM_WEBHOOK_SECURITY_KEY=

# ACH checkout provider for "Add Funds" (ACH payments)
# Options: billcom | increase
ACH_PAYMENT_PROVIDER=billcom

# Increase (ACH debit - verify first via micro pulls)
# Environment: sandbox or production
INCREASE_ENV=sandbox
# Optional override (default: https://sandbox.increase.com for sandbox, https://api.increase.com for production)
# INCREASE_API_URL=
INCREASE_API_KEY=
INCREASE_ACCOUNT_ID=
# Standard Webhooks secret (from Increase dashboard)
INCREASE_WEBHOOK_SECRET=
# Statement descriptor / company name (often limited to 16 chars)
INCREASE_COMPANY_NAME=TalkUSA
# Optional: company entry description (often limited to 10 chars)
# INCREASE_COMPANY_ENTRY_DESCRIPTION=TALKUSA
# Optional: webhook timestamp tolerance (seconds)
# INCREASE_WEBHOOK_TOLERANCE_SECONDS=300
# Backstop polling interval for hold-release reconciliation (minutes)
INCREASE_RECONCILE_INTERVAL_MINUTES=5

# Checkout limits for Add Funds (USD)
CHECKOUT_MIN_AMOUNT=100
CHECKOUT_MAX_AMOUNT=250
